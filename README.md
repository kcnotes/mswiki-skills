## About

This provides tooling to parse XML files generated by WzComparerR2, into JSON files that can be parsed by other tools.

## Setup
You will need node.js installed and configured in your preferred terminal. Confirm you have everything by making sure the following returns version numbers:

```
node -v
npm -v
```

Run `npm i` to install packages.

Using WzComparerR2, run it for both Skill and String. Run https://github.com/PirateIzzy/WzComparerR2/blob/master/WzComparerR2.LuaConsole/Examples/DumpXml.lua, changing `topNode` and `outputDir` as required.

### Version 

**Version 2 is now preferred over Version 1.** You'll benefit from 10x faster skill generation!

1. Place both the Skill and String folders into `mswiki-skills/xml`.

Your file structure should be:
```
> mswiki-skills
    - README.md
    > xml
      > String
        - Skill.img.xml
      > Skill
        - 000.img.xml
        - 100.img.xml
        ...
        - Recipe_9204.img.xml
```

Run `npm run start_v2 convert Skill`. 

If you've already put your folders in another place, you can choose to specify that folder by running `npm run start_v2 convert Skill -- -f "../to/folder"`.

### Version 1

1. Copy `String.img.xml` into `mswiki-skills`
2. Copy the `Skill` folder into `mswiki-skills` and rename to `Skill.wz`

Your file structure should be:
```
> mswiki-skills
    - README.md
    - Skill.img.xml
    > Skill.wz
        - 000.img.xml
        - 100.img.xml
        ...
        - Recipe_9204.img.xml
```

Run `npm start`!

There are three steps that will run. The second step is the slowest, as it's pairing up strings with skills. The output is a file called `all.json`.

If something goes wrong, you can perform a particular step using `npm start 1` (or 2 or 3).


## Recommendations
Delete the generated `out`, `tempbig`, `tempxml` and `finalxml` folders. They're not necessary once you have your `all.json`. Delete them (or change them in the code) if you are running Skill001 and Skill002 - unless you want to generate an all.json with all skills data.

## Viewing wiki skills
Open `index.html` in a browser and load the outputted `all.json`.

## Making changes
This is to make changes to transformations.

After changing any xslt, you need to convert it into SEF:
```bash
node transforms/build-transforms.js
node transforms/build-transforms.js etc.auctiondata.xslt
```

## New system
New script is a work in progress.

```bash
node index.2.js convert "Character.Accessory" -f "../xml"
```
